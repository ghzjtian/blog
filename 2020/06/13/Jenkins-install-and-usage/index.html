<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.pgyjz.cn","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"4BJ6VZJTPW","apiKey":"90ea15a5b51baec5c9e03f3368b46592","indexName":"blog","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="记录 Jenkins 在 Mac 上安装与使用的过程">
<meta property="og:type" content="article">
<meta property="og:title" content="Jenkins 的安装与使用">
<meta property="og:url" content="https://blog.pgyjz.cn/2020/06/13/Jenkins-install-and-usage/index.html">
<meta property="og:site_name" content="景天的博客">
<meta property="og:description" content="记录 Jenkins 在 Mac 上安装与使用的过程">
<meta property="og:locale">
<meta property="og:image" content="http://pic.pgyjz.cn/blog/Angular/Xnip2021-01-14_12-11-18.png">
<meta property="article:published_time" content="2020-06-13T09:46:19.000Z">
<meta property="article:modified_time" content="2021-01-23T03:40:33.880Z">
<meta property="article:author" content="Tim">
<meta property="article:tag" content="CI">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://pic.pgyjz.cn/blog/Angular/Xnip2021-01-14_12-11-18.png">

<link rel="canonical" href="https://blog.pgyjz.cn/2020/06/13/Jenkins-install-and-usage/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>Jenkins 的安装与使用 | 景天的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">景天的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://blog.pgyjz.cn/2020/06/13/Jenkins-install-and-usage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Tim">
      <meta itemprop="description" content="个人技术记录">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="景天的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Jenkins 的安装与使用
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-06-13 17:46:19" itemprop="dateCreated datePublished" datetime="2020-06-13T17:46:19+08:00">2020-06-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-23 11:40:33" itemprop="dateModified" datetime="2021-01-23T11:40:33+08:00">2021-01-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CI/" itemprop="url" rel="index"><span itemprop="name">CI</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>记录 Jenkins 在 Mac 上安装与使用的过程</p>
</blockquote>
<a id="more"></a>

<h2 id="1-参考"><a href="#1-参考" class="headerlink" title="1.参考"></a>1.参考</h2><ul>
<li>1.<a target="_blank" rel="noopener" href="https://www.jenkins.io/">Jenkins</a></li>
<li>2.<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/xamarin/tools/ci/jenkins-walkthrough">Using Jenkins with Xamarin</a></li>
<li>3.<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/54192905/how-to-save-jenkins-configuration">Save Jenkins configuration</a></li>
<li>4.<a target="_blank" rel="noopener" href="https://issues.jenkins-ci.org/browse/JENKINS-30107">Login Credentials Brute Force</a></li>
<li>5.<a target="_blank" rel="noopener" href="https://github.com/jenkinsci/jenkins">Jenkins Github</a></li>
</ul>
<h2 id="2-在-Mac-mini-上安装-Jenkins"><a href="#2-在-Mac-mini-上安装-Jenkins" class="headerlink" title="2.在 Mac mini 上安装 Jenkins"></a>2.在 Mac mini 上安装 Jenkins</h2><h4 id="1-下载安装"><a href="#1-下载安装" class="headerlink" title="1.下载安装"></a>1.下载安装</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jenkins.io/download/lts/macos/">1.Homebrew Installer</a><br><a target="_blank" rel="noopener" href="https://damien.co/general/how-to-start-stop-restart-or-reload-jenkins-mac-osx-8022/">2.How to Stop, Restart Jenkins - Common URL options</a><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/11062335/update-jenkins-from-a-war-file">3.Update Jenkins from a war file</a></p>
</blockquote>
<ul>
<li>1.使用 brew 下载</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">brew install jenkins-lts</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 会提示需下载 jdk 8(Jenkins-lts)</span><br><span class="line">brew cask install homebrew&#x2F;cask-versions&#x2F;adoptopenjdk8</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>2.开始/结束 等控制命令</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 作为服务类型去运行</span><br><span class="line">brew services start jenkins-lts</span><br><span class="line">brew services stop jenkins-lts</span><br><span class="line">brew services restart jenkins-lts</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 作为 命令行 程序去运行</span><br><span class="line">$ jenkins-lts</span><br><span class="line"></span><br><span class="line">开启后，可以使用浏览器去控制 Jenkins</span><br><span class="line">&#x2F;&#x2F; http:&#x2F;&#x2F;[jenkins-server]&#x2F;[command] where [command] can be</span><br><span class="line">exit -&gt; shutdown jenkins</span><br><span class="line">restart restart jenkins</span><br><span class="line">reload to reload the configuration</span><br><span class="line"></span><br><span class="line">如: http:&#x2F;&#x2F;10.100.1.172:8080&#x2F;restart 去重启 Jenkins</span><br></pre></td></tr></table></figure>


<h5 id="2-Jenkins-配置文件"><a href="#2-Jenkins-配置文件" class="headerlink" title="2.Jenkins 配置文件"></a>2.Jenkins 配置文件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~&#x2F;.jenkins&#x2F;config.xml</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;opt&#x2F;jenkins-lts&#x2F;homebrew.mxcl.jenkins-lts.plist</span><br><span class="line"></span><br><span class="line">任务文件路径:  ~&#x2F;.jenkins&#x2F;jobs&#x2F;[JOB NAME]</span><br><span class="line">任务配置文件路径:  ~&#x2F;.jenkins&#x2F;jobs&#x2F;[JOB NAME]&#x2F;config.xml</span><br><span class="line">项目文件路径: ~&#x2F;.jenkins&#x2F;workspace</span><br></pre></td></tr></table></figure>

<h5 id="3-更新"><a href="#3-更新" class="headerlink" title="3.更新"></a>3.更新</h5><ul>
<li>1.在 <code>Manage Jenkins -&gt; System Information</code> 中可以看到 <code>jenkins.war</code> 的文件的路径 <code>executable-war</code>，如这里为: </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">System Properties</span><br><span class="line">Name  			Value   </span><br><span class="line">awt.toolkit	sun.lwawt.macosx.LWCToolkit</span><br><span class="line">BUILD_TIMESTAMP	2020-07-06_02:30:05_CST</span><br><span class="line">executable-war	&#x2F;usr&#x2F;local&#x2F;Cellar&#x2F;jenkins-lts&#x2F;2.204.1&#x2F;libexec&#x2F;jenkins.war</span><br></pre></td></tr></table></figure>
<ul>
<li>2.在搭建的 <code>Jenkins Server</code> 中下载新版 <code>jenkins.war</code> 包.</li>
<li>3.停止 Jenkins: <code>brew services stop jenkins-lts</code></li>
<li>4.用新下载的 <code>jenkins.war</code> 替换 <code>/usr/local/Cellar/jenkins-lts/2.204.1/libexec/jenkins.war</code></li>
<li>5.重启 Jenkins: <code>brew services start jenkins-lts</code></li>
<li>6.Jenkins 的环境变量可以在 <code>http://localhost:8080/env-vars.html/</code> 看到, 也可以在项目的 <code>http://localhost:8080/view/Pipeline/job/idds-build-test2/job/test/pipeline-syntax/globals</code> 看到 Pipeline 的语法.</li>
</ul>
<h2 id="3-设置-Jenkins-中-Shell-的-PATH"><a href="#3-设置-Jenkins-中-Shell-的-PATH" class="headerlink" title="3.设置 Jenkins 中 Shell 的 PATH"></a>3.设置 Jenkins 中 Shell 的 PATH</h2><blockquote>
<p>如果不设置的话，会导致在 terminal 上能正常运行的脚本在 Jenkins 的 <code>Execute shell</code> 上不能正常运行.</p>
</blockquote>
<h5 id="1-参考-1"><a href="#1-参考-1" class="headerlink" title="1.参考"></a>1.参考</h5><ul>
<li>1.<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/15620369/jenkins-on-mac-path-is-not-set-right-no-usr-local-bin">jenkins on Mac, PATH is not set right, no /usr/local/bin</a></li>
</ul>
<h5 id="2-操作"><a href="#2-操作" class="headerlink" title="2.操作"></a>2.操作</h5><ul>
<li>1.编辑 Jenkins <code>/usr/local/Cellar/jenkins-lts/2.204.1/homebrew.mxcl.jenkins-lts.plist</code> 文件，添加 Mac 的 $PATH 到 Jenkins 中.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 输出 PATH</span><br><span class="line">echo $PATH </span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE plist PUBLIC &quot;-&#x2F;&#x2F;Apple&#x2F;&#x2F;DTD PLIST 1.0&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.apple.com&#x2F;DTDs&#x2F;PropertyList-1.0.dtd&quot;&gt;</span><br><span class="line">&lt;plist version&#x3D;&quot;1.0&quot;&gt;</span><br><span class="line">  &lt;dict&gt;</span><br><span class="line">    &lt;key&gt;Label&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;string&gt;homebrew.mxcl.jenkins-lts&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;key&gt;ProgramArguments&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;array&gt;</span><br><span class="line">      &lt;string&gt;&#x2F;usr&#x2F;libexec&#x2F;java_home&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;-v&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;1.8&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;--exec&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;java&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;-Dmail.smtp.starttls.enable&#x3D;true&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;-jar&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;&#x2F;usr&#x2F;local&#x2F;opt&#x2F;jenkins-lts&#x2F;libexec&#x2F;jenkins.war&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;--httpListenAddress&#x3D;127.0.0.1&lt;&#x2F;string&gt;</span><br><span class="line">      &lt;string&gt;--httpPort&#x3D;8080&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;&#x2F;array&gt;</span><br><span class="line">    &lt;key&gt;RunAtLoad&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;true&#x2F;&gt;</span><br><span class="line">    &lt;key&gt;EnvironmentVariables&lt;&#x2F;key&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">        &lt;key&gt;PATH&lt;&#x2F;key&gt;</span><br><span class="line">        &lt;string&gt;(You PATH)&lt;&#x2F;string&gt;</span><br><span class="line">    &lt;&#x2F;dict&gt;</span><br><span class="line">  &lt;&#x2F;dict&gt;</span><br><span class="line">&lt;&#x2F;plist&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="4-源代码管理"><a href="#4-源代码管理" class="headerlink" title="4.源代码管理"></a>4.源代码管理</h2><blockquote>
<p>首次安装完成后会自动安装 Git 插件</p>
</blockquote>
<h2 id="5-触发机制"><a href="#5-触发机制" class="headerlink" title="5.触发机制"></a>5.触发机制</h2><blockquote>
<p>一般选择 <code>Poll SCM</code></p>
</blockquote>
<h2 id="6-Build-的脚本"><a href="#6-Build-的脚本" class="headerlink" title="6.Build 的脚本"></a>6.Build 的脚本</h2><blockquote>
<p>在 Mac 上运行就选择 <code>Execute shell</code>, 然后执行的脚本格式跟在 terminal 上一样.</p>
</blockquote>
<h2 id="7-常用的插件"><a href="#7-常用的插件" class="headerlink" title="7.常用的插件"></a>7.常用的插件</h2><h4 id="1-Build-Timestamp"><a href="#1-Build-Timestamp" class="headerlink" title="1.Build Timestamp"></a>1.<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/44011594/5237440">Build Timestamp</a></h4><ul>
<li>1.让 Jenkins 使用 Timestamp</li>
</ul>
<h4 id="2-Email-Extension"><a href="#2-Email-Extension" class="headerlink" title="2.Email Extension"></a>2.<a target="_blank" rel="noopener" href="https://plugins.jenkins.io/email-ext/">Email Extension</a></h4><ul>
<li>1.使 Email 的格式更加丰富</li>
</ul>
<h4 id="3-Workspace-Cleanup"><a href="#3-Workspace-Cleanup" class="headerlink" title="3.Workspace Cleanup"></a>3.<a target="_blank" rel="noopener" href="https://plugins.jenkins.io/ws-cleanup/">Workspace Cleanup</a></h4><ul>
<li>1.在每次 Build 前就 Clean 整个项目.</li>
</ul>
<h4 id="4-Environment-Injector"><a href="#4-Environment-Injector" class="headerlink" title="4.Environment Injector"></a>4.<a target="_blank" rel="noopener" href="https://plugins.jenkins.io/envinject/">Environment Injector</a></h4><ul>
<li>1.插入 password 等等敏感的数据, 提供 项目 build 变量信息供项目访问.</li>
<li>2.但不支持 <code>Pipeline</code> 语法.</li>
</ul>
<h4 id="5-Delivery-Pipeline"><a href="#5-Delivery-Pipeline" class="headerlink" title="5.Delivery Pipeline"></a>5.Delivery Pipeline</h4><ul>
<li>1.可视化 任务管道传递</li>
</ul>
<h4 id="6-Role-based-Authorization"><a href="#6-Role-based-Authorization" class="headerlink" title="6.Role-based Authorization"></a>6.Role-based Authorization</h4><ul>
<li>1.角色权限管理</li>
</ul>
<h4 id="7-Pipeline-Utility-Steps"><a href="#7-Pipeline-Utility-Steps" class="headerlink" title="7.Pipeline Utility Steps"></a>7.Pipeline Utility Steps</h4><ul>
<li>1.Jenkins 常用的 Pipeline 工具.</li>
</ul>
<h4 id="8-Pipeline-Basic-Steps"><a href="#8-Pipeline-Basic-Steps" class="headerlink" title="8.Pipeline: Basic Steps"></a>8.<a target="_blank" rel="noopener" href="https://plugins.jenkins.io/workflow-basic-steps/">Pipeline: Basic Steps</a></h4><ul>
<li>1.Jenkins 常用的 Pipeline 命令.</li>
</ul>
<h2 id="8-过程及结果通知"><a href="#8-过程及结果通知" class="headerlink" title="8.过程及结果通知"></a>8.过程及结果通知</h2><h4 id="1-参考-2"><a href="#1-参考-2" class="headerlink" title="1.参考"></a>1.参考</h4><ul>
<li>1.<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/cb816b42673d">Jenkins配置邮件提醒</a></li>
<li>2.<a target="_blank" rel="noopener" href="https://bytefreaks.net/applications/jenkins-improve-the-format-of-the-email">邮件格式定义:Jenkins: Improve the format of the email</a></li>
</ul>
<h4 id="2-步骤"><a href="#2-步骤" class="headerlink" title="2.步骤"></a>2.步骤</h4><ul>
<li>1.Enable <code>Configure Global Security</code> -&gt; <code>Enable proxy compatibility</code></li>
<li>2.如设置 QQ ，则需要先 <a target="_blank" rel="noopener" href="https://service.mail.qq.com/cgi-bin/help?subtype=1&&id=28&&no=331">开启 SMTP 服务</a>,然后使用返回的授权码代替密码进行登录.</li>
<li>3.正确设置 邮件服务器的信息.</li>
</ul>
<h4 id="3-每个-build-都发送邮件"><a href="#3-每个-build-都发送邮件" class="headerlink" title="3.每个 build 都发送邮件"></a>3.每个 build 都发送邮件</h4><ul>
<li>1.<a target="_blank" rel="noopener" href="https://shalimatech.com/send-email-every-build-jenkins/">send email at every build</a></li>
</ul>
<h4 id="4-设置格式"><a href="#4-设置格式" class="headerlink" title="4.设置格式"></a>4.设置格式</h4><ul>
<li>1.发送人名字设置, 在 <code>Configure System</code> -&gt; <code>System Admin e-mail address</code> 设置为 <code>Name&lt;email address&gt;</code> 格式, 如: <code>Jenkins server &lt;123@qq.com&gt;</code>.</li>
</ul>
<h4 id="5-Eamil-模板参考"><a href="#5-Eamil-模板参考" class="headerlink" title="5.Eamil 模板参考"></a>5.Eamil 模板参考</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Hi All,</span><br><span class="line">    &lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;</span><br><span class="line">    $PROJECT_NAME - Build # $BUILD_NUMBER - $BUILD_STATUS.&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;</span><br><span class="line">    Click &lt;a href&#x3D;&quot;$BUILD_URL&#x2F;console&quot;&gt;$BUILD_URL&#x2F;console&lt;&#x2F;a&gt; to view full &lt;strong&gt;console output&lt;&#x2F;strong&gt; results.&lt;br&#x2F;&gt;</span><br><span class="line">    Click &lt;a href&#x3D;&quot;$JOB_URL&#x2F;ws&#x2F;README.md&quot;&gt;$JOB_URL&#x2F;ws&#x2F;README.md&lt;&#x2F;a&gt; to download the &lt;strong&gt;README.md&lt;&#x2F;strong&gt; file. &lt;br&#x2F;&gt;</span><br><span class="line">    If you cannot connect to the build server, check the attached logs.&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;</span><br><span class="line">    --&lt;br&#x2F;&gt;</span><br><span class="line">    Following is the last 100 lines of the log.&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;</span><br><span class="line">    --LOG-BEGIN--&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;pre style&#x3D;&#39;line-height: 22px; display: block; color: #333; font-family: Monaco,Menlo,Consolas,&quot;Courier New&quot;,monospace; padding: 10.5px; margin: 0 0 11px; font-size: 13px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; background-color: #f5f5f5; border: 1px solid #ccc; border: 1px solid rgba(0,0,0,.15); -webkit-border-radius: 4px; -moz-border-radius: 4px; border-radius: 4px;&#39;&gt;</span><br><span class="line">    $&#123;BUILD_LOG, maxLines&#x3D;100, escapeHtml&#x3D;true&#125;</span><br><span class="line">    &lt;&#x2F;pre&gt;</span><br><span class="line">    --LOG-END--</span><br><span class="line">    &lt;br&#x2F;&gt;</span><br><span class="line">    &lt;br&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">From: Mac mini&#39;s Jenkins server &lt;$BUILD_TIMESTAMP&gt;</span><br></pre></td></tr></table></figure>



<h2 id="9-用户管理"><a href="#9-用户管理" class="headerlink" title="9.用户管理"></a>9.用户管理</h2><blockquote>
<p>需要 <a target="_blank" rel="noopener" href="https://plugins.jenkins.io/matrix-auth/"><code>Matrix Authorization Strategy</code></a> 插件</p>
</blockquote>
<h4 id="1-参考-3"><a href="#1-参考-3" class="headerlink" title="1.参考"></a>1.参考</h4><ul>
<li>1.<a target="_blank" rel="noopener" href="https://www.edureka.co/community/47822/there-restrict-permissions-user-per-individual-job-jenkins">A way to restrict permissions to a user per individual job in jenkins</a></li>
<li>2.<a target="_blank" rel="noopener" href="https://wiki.jenkins.io/display/jenkins/standard+security+setup">Standard Security Setup(wiki.jenkins.io)</a></li>
<li>3.<a target="_blank" rel="noopener" href="http://abhijitkakade.com/2019/06/how-to-reset-jenkins-admin-users-password/">How to Reset Jenkins Admin users Password</a></li>
</ul>
<h4 id="2-具体操作"><a href="#2-具体操作" class="headerlink" title="2.具体操作"></a>2.具体操作</h4><ul>
<li><p>1.From the jenkins dashboard,click on Manage Jenkins.</p>
</li>
<li><p>2.under Manage jenkins-&gt;Configure Global Security-&gt;select Enable security.</p>
</li>
<li><p>3.Under the Authorization section, select the “Project-based Matrix Authorization Strategy”</p>
</li>
<li><p>4.Add the particular user and assign the appropriate permissions.(用户必须在这里有 <code>Overall -&gt; Read</code> 的权限，否则在子项目配置的权限也会没有效果.)</p>
</li>
<li><p>5.And then to assign Job specific permissions :</p>
<ul>
<li><p>1.Go to the job (say job1) for which you need to assign permissions.</p>
</li>
<li><p>2.Click Configure-&gt;under the general tab-&gt;Enable Project-based Security.</p>
</li>
<li><p>3.Add the particular user (say user1) and assign the required permissions.</p>
</li>
</ul>
</li>
</ul>
<h2 id="10-自动打包-Xamarin-Android-项目"><a href="#10-自动打包-Xamarin-Android-项目" class="headerlink" title="10.自动打包 Xamarin.Android 项目"></a>10.自动打包 <code>Xamarin.Android</code> 项目</h2><h4 id="0-前期准备"><a href="#0-前期准备" class="headerlink" title="0.前期准备"></a>0.前期准备</h4><h5 id="1-Mac-安装-xmlstarlet-软件"><a href="#1-Mac-安装-xmlstarlet-软件" class="headerlink" title="1.Mac 安装 xmlstarlet 软件."></a>1.Mac 安装 xmlstarlet 软件.</h5><ul>
<li><p>1.安装 <a target="_blank" rel="noopener" href="http://macappstore.org/xmlstarlet/"><code>xmlstarlet</code>(Mac xml 解析器)</a></p>
<ul>
<li>1.因为打包后生成的 APK 包需要附上版本号，要读取 <code>AndroidManifest.xml</code> 文件才能完成这个操作. </li>
<li>2.安装: <code>brew install xmlstarlet</code></li>
</ul>
</li>
<li><p>2.使用方法</p>
<ul>
<li>1.<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/17333937/5237440">Extract XML Value in bash script</a></li>
<li>2.<a target="_blank" rel="noopener" href="http://xmlstar.sourceforge.net/doc/UG/xmlstarlet-ug.html">XmlStarlet Command Line XML Toolkit User’s Guide</a></li>
</ul>
</li>
<li><p>3.例子</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; input.xml</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;Environment xmlns:android&#x3D;&quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&quot; xmlns&#x3D;&quot;http:&#x2F;&#x2F;schemas.dmtf.org&#x2F;ovf&#x2F;environment&#x2F;1&quot; xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot; xmlns:oe&#x3D;&quot;http:&#x2F;&#x2F;schemas.dmtf.org&#x2F;ovf&#x2F;environment&#x2F;1&quot; xmlns:ve&#x3D;&quot;http:&#x2F;&#x2F;www.vmware.com&#x2F;schema&#x2F;ovfenv&quot; oe:id&#x3D;&quot;customerId&quot; ve:vCenterId&#x3D;&quot;centerID&quot; android:versionCode&#x3D;&quot;251&quot; android:versionName&#x3D;&quot;2.4.0&quot; &gt;</span><br><span class="line">  &lt;PropertySection&gt;</span><br><span class="line">&lt;Property oe:key&#x3D;&quot;vami.hostname&quot; oe:value&#x3D;&quot;jal&quot;&#x2F;&gt;</span><br><span class="line">&lt;Property oe:key&#x3D;&quot;vamitimezone&quot; oe:value&#x3D;&quot;Asia&#x2F;Kolkata&quot;&#x2F;&gt;</span><br><span class="line">&lt;Property oe:key&#x3D;&quot;ABC_enable&quot; oe:value&#x3D;&quot;1&quot;&#x2F;&gt;</span><br><span class="line">&lt;Property oe:key&#x3D;&quot;software_only_installer_name&quot; oe:value&#x3D;&quot;install-r8-0-0-0&quot;&#x2F;&gt;</span><br><span class="line">&lt;Property oe:key&#x3D;&quot;software_only_staging_dir&quot; oe:value&#x3D;&quot;&#x2F;media&#x2F;dir&quot;&#x2F;&gt;</span><br><span class="line">&lt;Property oe:key&#x3D;&quot;software_only_mount_dir&quot; oe:value&#x3D;&quot;&#x2F;media&#x2F;cdrom&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;PropertySection&gt;</span><br><span class="line">&lt;&#x2F;Environment&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ xmlstarlet sel -t -v &quot;&#x2F;&#x2F;@android:versionCode&quot; input.xml</span><br><span class="line">&#x2F;&#x2F; Output: 251</span><br><span class="line"></span><br><span class="line">$ xmlstarlet sel -t -v &quot;&#x2F;&#x2F;@ve:vCenterId&quot; input.xml</span><br><span class="line">&#x2F;&#x2F; Output: centerID</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-把-zipalign-添加到个人目录的环境变量中"><a href="#2-把-zipalign-添加到个人目录的环境变量中" class="headerlink" title="2.把 zipalign 添加到个人目录的环境变量中"></a>2.把 zipalign 添加到个人目录的环境变量中</h5><blockquote>
<p>Android 打包需要用到的工具.</p>
</blockquote>
<h6 id="1-参考-4"><a href="#1-参考-4" class="headerlink" title="1.参考"></a>1.参考</h6><ul>
<li>1.<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/55135196/5237440">Zipalign - Command not found - MAC terminal</a></li>
</ul>
<h6 id="2-配置-zipalign-环境"><a href="#2-配置-zipalign-环境" class="headerlink" title="2.配置 zipalign 环境"></a>2.配置 zipalign 环境</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 查找 zipalign 位置</span><br><span class="line">$ find ~&#x2F;Library&#x2F;Developer&#x2F;Xamarin -name &quot;zipalign&quot;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 把 zipalign 放置到 个人环境目录下</span><br><span class="line">$ echo &quot;export PATH&#x3D;\$PATH:~&#x2F;Library&#x2F;Developer&#x2F;Xamarin&#x2F;android-sdk-macosx&#x2F;build-tools&#x2F;29.0.2&quot; &gt;&gt; ~&#x2F;.bash_profile &amp;&amp; . ~&#x2F;.bash_profile</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 测试效果</span><br><span class="line">$ zipalign</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="3-实际效果"><a href="#3-实际效果" class="headerlink" title="3.实际效果"></a>3.实际效果</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 模板</span><br><span class="line">zipalign -f -v 4 yourSigned.apk yourFinaleApk</span><br><span class="line"></span><br><span class="line">zipalign -f -v 4 $WORKSPACE&#x2F;BLE_APP.Android&#x2F;Bin&#x2F;Release&#x2F;com.glb.BLE_APP-Signed.apk $WORKSPACE&#x2F;BLE_APP.Android&#x2F;Bin&#x2F;Release&#x2F;finalApp.apk</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="1-项目参数的保存"><a href="#1-项目参数的保存" class="headerlink" title="1.项目参数的保存"></a>1.项目参数的保存</h4><ul>
<li>0.Build Environment</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Delete workspace before build starts</span><br><span class="line">Add timestamps to the Console Output</span><br><span class="line"></span><br><span class="line">Inject passwords to the build as environment variables(STORE_PASS)</span><br></pre></td></tr></table></figure>

<ul>
<li>1.Excute shell</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pwd</span><br><span class="line"></span><br><span class="line">whoami</span><br><span class="line"></span><br><span class="line">cd MowerGG</span><br><span class="line"></span><br><span class="line">nuget restore</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>2.Inject Environment</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">KEYSTORE_FILE &#x3D; &#x2F;Users&#x2F;glb_gz&#x2F;Desktop&#x2F;GreenworksGreenGuide.keystore</span><br><span class="line">KEYSTORE_ALIAS &#x3D; GreenworksGreenGuide</span><br><span class="line"></span><br><span class="line">APK_BIN_PATH &#x3D;  $WORKSPACE&#x2F;MowerGG&#x2F;MowerGG.Android&#x2F;bin</span><br><span class="line">MANIFEST_PATH &#x3D; $WORKSPACE&#x2F;MowerGG&#x2F;MowerGG.Android&#x2F;Properties</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>4.Excute shell</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># 必须放置在这里(这个 Execute shell)，否则后面的执行会读取不到这个值</span><br><span class="line">declare -a Environments&#x3D;(</span><br><span class="line">                 &quot;Brand1 - Dev2;AndroidManifest1.xml&quot;</span><br><span class="line">                 &quot;Brand2 - Dev2;AndroidManifest2.xml&quot;</span><br><span class="line">                )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">StartJarSignAndZip() &#123;</span><br><span class="line"></span><br><span class="line">	versionName&#x3D;$(xmlstarlet sel -t -v &quot;&#x2F;&#x2F;@android:versionName&quot; &quot;$MANIFEST_PATH&quot;&#x2F;&quot;$2&quot;)</span><br><span class="line">	versionCode&#x3D;$(xmlstarlet sel -t -v &quot;&#x2F;&#x2F;@android:versionCode&quot; &quot;$MANIFEST_PATH&quot;&#x2F;&quot;$2&quot;)</span><br><span class="line">	packageName&#x3D;$(xmlstarlet sel -t -v &quot;&#x2F;&#x2F;@package&quot; &quot;$MANIFEST_PATH&quot;&#x2F;&quot;$2&quot;)</span><br><span class="line"></span><br><span class="line">	INPUT_APK&#x3D;&quot;$APK_BIN_PATH&quot;&#x2F;&quot;$1&quot;&#x2F;&quot;$packageName&quot;&quot;.apk&quot;</span><br><span class="line">    SIGNED_APK&#x3D;&quot;$APK_BIN_PATH&quot;&#x2F;&quot;$1&quot;&#x2F;&quot;$packageName&quot;&quot;-Signed.apk&quot;</span><br><span class="line">    FINAL_APK&#x3D;&quot;$APK_BIN_PATH&quot;&#x2F;&quot;$1&quot;&#x2F;&quot;$packageName&quot;&quot;_$versionName&quot;&quot;.$versionCode&quot;&quot;.apk&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	jarsigner -verbose -sigalg MD5withRSA -digestalg SHA1 -keystore $KEYSTORE_FILE -storepass $STORE_PASS -signedjar &quot;$SIGNED_APK&quot; &quot;$INPUT_APK&quot; $KEYSTORE_ALIAS</span><br><span class="line"></span><br><span class="line">	zipalign -f -v 4 &quot;$SIGNED_APK&quot; &quot;$FINAL_APK&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">StartMSBuild() &#123;</span><br><span class="line">	msbuild &#x2F;p:Configuration&#x3D;&quot;$1&quot; &#x2F;t:PackageForAndroid &#x2F;t:SignAndroidPackage  MowerGG&#x2F;MowerGG.Android&#x2F;Globe.IoT.App.GreenGuide.Android.csproj</span><br><span class="line">	</span><br><span class="line">    StartJarSignAndZip &quot;$1&quot; &quot;$2&quot;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for environment in &quot;$&#123;Environments[@]&#125;&quot;</span><br><span class="line">   do</span><br><span class="line">     echo &quot;$environment&quot;</span><br><span class="line">     configuration&#x3D;$(echo &quot;$environment&quot; | awk -F&#39;;&#39; &#39;&#123;print $1&#125;&#39;)</span><br><span class="line">     manifestFileName&#x3D;$(echo &quot;$environment&quot; | awk -F&#39;;&#39; &#39;&#123;print $2&#125;&#39;)</span><br><span class="line">     StartMSBuild &quot;$configuration&quot; &quot;$manifestFileName&quot;</span><br><span class="line">   done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="11-打包-Xamarin-iOS-项目"><a href="#11-打包-Xamarin-iOS-项目" class="headerlink" title="11.打包 Xamarin.iOS 项目"></a>11.打包 <code>Xamarin.iOS</code> 项目</h2><h4 id="1-参考-5"><a href="#1-参考-5" class="headerlink" title="1.参考"></a>1.参考</h4><ul>
<li>1.<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/xamarin/ios/deploy-test/app-distribution/ipa-support?tabs=macos">IPA Support in Xamarin.iOS</a></li>
</ul>
<h4 id="2-过程"><a href="#2-过程" class="headerlink" title="2.过程"></a>2.过程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msbuild &#x2F;p:Configuration&#x3D;&quot;APP.iOS - Develop&quot; &#x2F;p:Platform&#x3D;&quot;iPhone&quot; &#x2F;p:IpaPackageDir&#x3D;&quot;&#x2F;Users&#x2F;user&#x2F;Desktop&quot; &#x2F;p:BuildIpa&#x3D;true &#x2F;t:Build Globe.IoT.App.GreenGuide.iOS.csproj</span><br></pre></td></tr></table></figure>






<p>/Users/glb_gz/Documents/Xamarin_Workplace/ggmowerapp/MowerGG/MowerGG.iOS/Globe.IoT.App.GreenGuide.iOS.csproj</p>
<h2 id="12-在-Windows-上安装"><a href="#12-在-Windows-上安装" class="headerlink" title="12.在 Windows 上安装"></a>12.在 <code>Windows</code> 上安装</h2><h3 id="1-下载"><a href="#1-下载" class="headerlink" title="1.下载"></a>1.下载</h3><ul>
<li>1.下载 <a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase-jre8-downloads.html">jre8</a></li>
<li>2.下载 <a target="_blank" rel="noopener" href="https://www.jenkins.io/download/thank-you-downloading-windows-installer-stable/">jenkins</a></li>
</ul>
<h3 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h3><ul>
<li>1.按提示安装</li>
</ul>
<h3 id="3-配置"><a href="#3-配置" class="headerlink" title="3.配置"></a>3.配置</h3><ul>
<li>1.配置 <code>git.exe</code> 路径.</li>
<li>2.配置 <code>ssh</code> private key.</li>
</ul>
<h3 id="4-作为-Node-节点服务器"><a href="#4-作为-Node-节点服务器" class="headerlink" title="4.作为 Node 节点服务器"></a>4.作为 Node 节点服务器</h3><h4 id="1-参考-6"><a href="#1-参考-6" class="headerlink" title="1.参考"></a>1.参考</h4><ul>
<li>1.<a target="_blank" rel="noopener" href="https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+as+a+Windows+service">Installing Jenkins as a Windows service</a></li>
<li>2.<a target="_blank" rel="noopener" href="https://www.edureka.co/blog/jenkins-master-and-slave-architecture-a-complete-guide/">Jenkins Master and Slave Architecture – A Complete Guide</a></li>
<li>3.<a target="_blank" rel="noopener" href="https://www.studytonight.com/jenkins/jenkins-master-slave-configuration">Jenkins Master Slave Configuration</a></li>
<li>4.<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=rr-R955N4nM">Youtube-Jenkins Master/Slaver</a></li>
</ul>
<h4 id="2-安装-1"><a href="#2-安装-1" class="headerlink" title="2.安装"></a>2.安装</h4><h5 id="1-在-Master-机器的-Jenjins-上添加-Node-然后如下图的配置"><a href="#1-在-Master-机器的-Jenjins-上添加-Node-然后如下图的配置" class="headerlink" title="1.在 Master 机器的 Jenjins 上添加 Node, 然后如下图的配置"></a>1.在 Master 机器的 Jenjins 上添加 Node, 然后如下图的配置</h5><ul>
<li>1.以后每次修改后都需要重新连接 Slave</li>
<li>2.添加 Slave 的 Git 执行路径到 配置 <code>Tool Locations</code> 中. </li>
<li>3.<code>Remote root directory</code> 填写 Slave 保存的项目源码路径.</li>
</ul>
<p><img src="http://pic.pgyjz.cn/blog/Angular/Xnip2021-01-14_12-11-18.png"></p>
<h5 id="2-在-Slave-机器上用浏览器登录-Master-的-Jenkins-下载-agent-jar文件"><a href="#2-在-Slave-机器上用浏览器登录-Master-的-Jenkins-下载-agent-jar文件" class="headerlink" title="2.在 Slave 机器上用浏览器登录 Master 的 Jenkins, 下载 agent.jar文件"></a>2.在 Slave 机器上用浏览器登录 Master 的 Jenkins, 下载 <code>agent.jar</code>文件</h5><h5 id="3-编写-bat-脚本-内容如下，然后保存为-Jenkins-bat"><a href="#3-编写-bat-脚本-内容如下，然后保存为-Jenkins-bat" class="headerlink" title="3.编写 bat 脚本,内容如下，然后保存为 Jenkins.bat"></a>3.编写 bat 脚本,内容如下，然后保存为 <code>Jenkins.bat</code></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar D:\Jenkins\agent.jar -jnlpUrl http:&#x2F;&#x2F;10.100.1.172:8081&#x2F;computer&#x2F;GZ-Developer-Computer(Slave1)&#x2F;slave-agent.jnlp -secret 05ddb1dcdfd108fe30f40e194d13c4755af31e65f969b84ed959b3780bbf2310 -workDir &quot;D:\Jenkins\Slave&quot;</span><br></pre></td></tr></table></figure>

<h5 id="4-设置脚本开机自动运行"><a href="#4-设置脚本开机自动运行" class="headerlink" title="4.设置脚本开机自动运行"></a>4.设置脚本开机自动运行</h5><ul>
<li>1.打开运行，然后输入 <code>shell:common startup</code>， 就会打开 <code>系统启动文件夹</code></li>
<li>2.把脚本 <code>Jenkins.bat</code> 放到 <code>系统启动文件夹</code> 下</li>
<li>3.但发现以后要登录计算机，才会触发脚本自动运行!!!</li>
</ul>
<h5 id="5-现在在-Master-Jenkins-上可以看到-Slave-Jenkins-的相关信息"><a href="#5-现在在-Master-Jenkins-上可以看到-Slave-Jenkins-的相关信息" class="headerlink" title="5.现在在 Master Jenkins 上可以看到 Slave Jenkins 的相关信息."></a>5.现在在 Master Jenkins 上可以看到 Slave Jenkins 的相关信息.</h5><h4 id="3-项目配置"><a href="#3-项目配置" class="headerlink" title="3.项目配置"></a>3.项目配置</h4><ul>
<li>1.Git 需要新创建一个 <code>Credentials</code> , 如果用 ssh 验证，需要 Slave 机器的 <code>ssh private key</code>.</li>
<li>2.项目的 <code>General/Restrict where this project can be run</code> 填写 <code>Slave</code> 的 <code>Label</code></li>
</ul>
<h3 id="5-辅助工具"><a href="#5-辅助工具" class="headerlink" title="5.辅助工具"></a>5.辅助工具</h3><ul>
<li>1.<a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=janjoerke.jenkins-pipeline-linter-connector">Jenkins Pipeline Linter Connector(VS code plugin)</a></li>
</ul>
<h2 id="13-Multi-Pipe-line"><a href="#13-Multi-Pipe-line" class="headerlink" title="13.Multi Pipe line"></a>13.Multi Pipe line</h2><h3 id="1-参考-7"><a href="#1-参考-7" class="headerlink" title="1.参考"></a>1.参考</h3><ul>
<li>1.<a target="_blank" rel="noopener" href="https://tomd.xyz/jenkins-shared-library/">Jenkins shared library: tutorial with examples</a></li>
</ul>
<h3 id="2-内部库"><a href="#2-内部库" class="headerlink" title="2.内部库"></a>2.内部库</h3><blockquote>
<p>因为 Jenkins 认为项目的 Jenkinsfile 脚本是不安全的，并且一些常用的代码共用的原则，所以需要内部库的支持.</p>
</blockquote>
<h4 id="1-Jenkins-内部的-workflowLibs-库"><a href="#1-Jenkins-内部的-workflowLibs-库" class="headerlink" title="1.Jenkins 内部的 workflowLibs 库"></a>1.Jenkins 内部的 workflowLibs 库</h4><ul>
<li>1.Git remote 为: <code>origin    ssh://tian@localhost:22222/workflowLibs.git (fetch)</code>.</li>
</ul>
<h4 id="2-Git-库"><a href="#2-Git-库" class="headerlink" title="2.Git 库"></a>2.Git 库</h4><ul>
<li>1.可以放在 Gitlab 或 Github</li>
<li>2.在 <code>Global Pipeline Libraries </code> 配置<ul>
<li>1.Name to <code>pipeline-library</code></li>
<li>2.Default version to <code>master</code></li>
<li>3.Select <code>Modern SCM</code>/<code>Git</code> and input your <code>Project Repository</code> and select <code>Credentials</code></li>
<li>4.Save, and each project import this library , this library will auto download to workspace.</li>
</ul>
</li>
</ul>
<h3 id="3-项目-Jenkinsfile-文件的配置及使用"><a href="#3-项目-Jenkinsfile-文件的配置及使用" class="headerlink" title="3.项目 Jenkinsfile 文件的配置及使用"></a>3.项目 Jenkinsfile 文件的配置及使用</h3><h4 id="1-Import-the-library"><a href="#1-Import-the-library" class="headerlink" title="1.Import the library"></a>1.Import the library</h4><ul>
<li>1.Example: <code>@Library(&#39;jenkins-build-script&#39;)_</code></li>
</ul>
<h4 id="2-Usage"><a href="#2-Usage" class="headerlink" title="2.Usage"></a>2.Usage</h4><ul>
<li>1.Use <code>executeCommand xxx</code> or <code>getDotnetProjectVersion(xxx)</code> to execute the command in vars.</li>
<li>2.Or use <code>import com.globe.IotXmlParser</code> to import the class and then execute its command.</li>
</ul>
<h4 id="3-Jenkinsfile-Example"><a href="#3-Jenkinsfile-Example" class="headerlink" title="3.Jenkinsfile Example"></a>3.<code>Jenkinsfile</code> Example</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-Master-gt-Slave-架构上使用-Pipeline"><a href="#4-Master-gt-Slave-架构上使用-Pipeline" class="headerlink" title="4.Master -&gt; Slave 架构上使用 Pipeline"></a>4.Master -&gt; Slave 架构上使用 Pipeline</h3><h4 id="1-有-shared-library-时"><a href="#1-有-shared-library-时" class="headerlink" title="1.有 shared library 时"></a>1.有 <code>shared library</code> 时</h4><ul>
<li>1.<code>library</code> 会下载到 Master</li>
<li>2.<code>Project code</code> 会下载到 Slave</li>
<li>3.如果需要 <code>shared library</code> 读取文件, 不能通过传递文件名让 <code>shared library</code> 读取，这样会找不到, 应该用 插件 <code>Pipeline: Basic Steps </code> 的 <code>readFile</code> 方法去读取文件内容，再传递到 <code>shared library</code> 去处理,但是要注意处理前先去除文件的 <code>字节顺序标记（英语：byte-order mark，BOM）</code> 否则会可能出错, 如 Groovy 的 <code>XmlParser().parseText</code> 会出现 <code>org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Content is not allowed in prolog.</code> 错误.</li>
<li>4.用 <code>Xcode</code> 打开文件查看 HEX 的方法: <a target="_blank" rel="noopener" href="https://stackoverflow.com/a/10237422/5237440">What’s a good hex editor/viewer for the Mac?</a></li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CI/" rel="tag"># CI</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/06/11/Mac-crontab/" rel="prev" title="Mac 创建定时任务">
      <i class="fa fa-chevron-left"></i> Mac 创建定时任务
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/07/11/Appium-Learn(python)/" rel="next" title="Appium 自动化测试(python3)">
      Appium 自动化测试(python3) <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%8F%82%E8%80%83"><span class="nav-number">1.</span> <span class="nav-text">1.参考</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%9C%A8-Mac-mini-%E4%B8%8A%E5%AE%89%E8%A3%85-Jenkins"><span class="nav-number">2.</span> <span class="nav-text">2.在 Mac mini 上安装 Jenkins</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85"><span class="nav-number">2.0.1.</span> <span class="nav-text">1.下载安装</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-Jenkins-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">2.0.1.1.</span> <span class="nav-text">2.Jenkins 配置文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E6%9B%B4%E6%96%B0"><span class="nav-number">2.0.1.2.</span> <span class="nav-text">3.更新</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E8%AE%BE%E7%BD%AE-Jenkins-%E4%B8%AD-Shell-%E7%9A%84-PATH"><span class="nav-number">3.</span> <span class="nav-text">3.设置 Jenkins 中 Shell 的 PATH</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%8F%82%E8%80%83-1"><span class="nav-number">3.0.0.1.</span> <span class="nav-text">1.参考</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%93%8D%E4%BD%9C"><span class="nav-number">3.0.0.2.</span> <span class="nav-text">2.操作</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E6%BA%90%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86"><span class="nav-number">4.</span> <span class="nav-text">4.源代码管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E8%A7%A6%E5%8F%91%E6%9C%BA%E5%88%B6"><span class="nav-number">5.</span> <span class="nav-text">5.触发机制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Build-%E7%9A%84%E8%84%9A%E6%9C%AC"><span class="nav-number">6.</span> <span class="nav-text">6.Build 的脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8F%92%E4%BB%B6"><span class="nav-number">7.</span> <span class="nav-text">7.常用的插件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Build-Timestamp"><span class="nav-number">7.0.1.</span> <span class="nav-text">1.Build Timestamp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Email-Extension"><span class="nav-number">7.0.2.</span> <span class="nav-text">2.Email Extension</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-Workspace-Cleanup"><span class="nav-number">7.0.3.</span> <span class="nav-text">3.Workspace Cleanup</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-Environment-Injector"><span class="nav-number">7.0.4.</span> <span class="nav-text">4.Environment Injector</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-Delivery-Pipeline"><span class="nav-number">7.0.5.</span> <span class="nav-text">5.Delivery Pipeline</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-Role-based-Authorization"><span class="nav-number">7.0.6.</span> <span class="nav-text">6.Role-based Authorization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-Pipeline-Utility-Steps"><span class="nav-number">7.0.7.</span> <span class="nav-text">7.Pipeline Utility Steps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-Pipeline-Basic-Steps"><span class="nav-number">7.0.8.</span> <span class="nav-text">8.Pipeline: Basic Steps</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E8%BF%87%E7%A8%8B%E5%8F%8A%E7%BB%93%E6%9E%9C%E9%80%9A%E7%9F%A5"><span class="nav-number">8.</span> <span class="nav-text">8.过程及结果通知</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%8F%82%E8%80%83-2"><span class="nav-number">8.0.1.</span> <span class="nav-text">1.参考</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%AD%A5%E9%AA%A4"><span class="nav-number">8.0.2.</span> <span class="nav-text">2.步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%AF%8F%E4%B8%AA-build-%E9%83%BD%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6"><span class="nav-number">8.0.3.</span> <span class="nav-text">3.每个 build 都发送邮件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E8%AE%BE%E7%BD%AE%E6%A0%BC%E5%BC%8F"><span class="nav-number">8.0.4.</span> <span class="nav-text">4.设置格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-Eamil-%E6%A8%A1%E6%9D%BF%E5%8F%82%E8%80%83"><span class="nav-number">8.0.5.</span> <span class="nav-text">5.Eamil 模板参考</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="nav-number">9.</span> <span class="nav-text">9.用户管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%8F%82%E8%80%83-3"><span class="nav-number">9.0.1.</span> <span class="nav-text">1.参考</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%85%B7%E4%BD%93%E6%93%8D%E4%BD%9C"><span class="nav-number">9.0.2.</span> <span class="nav-text">2.具体操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-%E8%87%AA%E5%8A%A8%E6%89%93%E5%8C%85-Xamarin-Android-%E9%A1%B9%E7%9B%AE"><span class="nav-number">10.</span> <span class="nav-text">10.自动打包 Xamarin.Android 项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0-%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87"><span class="nav-number">10.0.1.</span> <span class="nav-text">0.前期准备</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-Mac-%E5%AE%89%E8%A3%85-xmlstarlet-%E8%BD%AF%E4%BB%B6"><span class="nav-number">10.0.1.1.</span> <span class="nav-text">1.Mac 安装 xmlstarlet 软件.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%8A%8A-zipalign-%E6%B7%BB%E5%8A%A0%E5%88%B0%E4%B8%AA%E4%BA%BA%E7%9B%AE%E5%BD%95%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E4%B8%AD"><span class="nav-number">10.0.1.2.</span> <span class="nav-text">2.把 zipalign 添加到个人目录的环境变量中</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-%E5%8F%82%E8%80%83-4"><span class="nav-number">10.0.1.2.1.</span> <span class="nav-text">1.参考</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-%E9%85%8D%E7%BD%AE-zipalign-%E7%8E%AF%E5%A2%83"><span class="nav-number">10.0.1.2.2.</span> <span class="nav-text">2.配置 zipalign 环境</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-%E5%AE%9E%E9%99%85%E6%95%88%E6%9E%9C"><span class="nav-number">10.0.1.2.3.</span> <span class="nav-text">3.实际效果</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E9%A1%B9%E7%9B%AE%E5%8F%82%E6%95%B0%E7%9A%84%E4%BF%9D%E5%AD%98"><span class="nav-number">10.0.2.</span> <span class="nav-text">1.项目参数的保存</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-%E6%89%93%E5%8C%85-Xamarin-iOS-%E9%A1%B9%E7%9B%AE"><span class="nav-number">11.</span> <span class="nav-text">11.打包 Xamarin.iOS 项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%8F%82%E8%80%83-5"><span class="nav-number">11.0.1.</span> <span class="nav-text">1.参考</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%BF%87%E7%A8%8B"><span class="nav-number">11.0.2.</span> <span class="nav-text">2.过程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-%E5%9C%A8-Windows-%E4%B8%8A%E5%AE%89%E8%A3%85"><span class="nav-number">12.</span> <span class="nav-text">12.在 Windows 上安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E4%B8%8B%E8%BD%BD"><span class="nav-number">12.1.</span> <span class="nav-text">1.下载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%AE%89%E8%A3%85"><span class="nav-number">12.2.</span> <span class="nav-text">2.安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%85%8D%E7%BD%AE"><span class="nav-number">12.3.</span> <span class="nav-text">3.配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E4%BD%9C%E4%B8%BA-Node-%E8%8A%82%E7%82%B9%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-number">12.4.</span> <span class="nav-text">4.作为 Node 节点服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%8F%82%E8%80%83-6"><span class="nav-number">12.4.1.</span> <span class="nav-text">1.参考</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%AE%89%E8%A3%85-1"><span class="nav-number">12.4.2.</span> <span class="nav-text">2.安装</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%9C%A8-Master-%E6%9C%BA%E5%99%A8%E7%9A%84-Jenjins-%E4%B8%8A%E6%B7%BB%E5%8A%A0-Node-%E7%84%B6%E5%90%8E%E5%A6%82%E4%B8%8B%E5%9B%BE%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">12.4.2.1.</span> <span class="nav-text">1.在 Master 机器的 Jenjins 上添加 Node, 然后如下图的配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E5%9C%A8-Slave-%E6%9C%BA%E5%99%A8%E4%B8%8A%E7%94%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E7%99%BB%E5%BD%95-Master-%E7%9A%84-Jenkins-%E4%B8%8B%E8%BD%BD-agent-jar%E6%96%87%E4%BB%B6"><span class="nav-number">12.4.2.2.</span> <span class="nav-text">2.在 Slave 机器上用浏览器登录 Master 的 Jenkins, 下载 agent.jar文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E7%BC%96%E5%86%99-bat-%E8%84%9A%E6%9C%AC-%E5%86%85%E5%AE%B9%E5%A6%82%E4%B8%8B%EF%BC%8C%E7%84%B6%E5%90%8E%E4%BF%9D%E5%AD%98%E4%B8%BA-Jenkins-bat"><span class="nav-number">12.4.2.3.</span> <span class="nav-text">3.编写 bat 脚本,内容如下，然后保存为 Jenkins.bat</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E8%AE%BE%E7%BD%AE%E8%84%9A%E6%9C%AC%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C"><span class="nav-number">12.4.2.4.</span> <span class="nav-text">4.设置脚本开机自动运行</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-%E7%8E%B0%E5%9C%A8%E5%9C%A8-Master-Jenkins-%E4%B8%8A%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0-Slave-Jenkins-%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF"><span class="nav-number">12.4.2.5.</span> <span class="nav-text">5.现在在 Master Jenkins 上可以看到 Slave Jenkins 的相关信息.</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE"><span class="nav-number">12.4.3.</span> <span class="nav-text">3.项目配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7"><span class="nav-number">12.5.</span> <span class="nav-text">5.辅助工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-Multi-Pipe-line"><span class="nav-number">13.</span> <span class="nav-text">13.Multi Pipe line</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%8F%82%E8%80%83-7"><span class="nav-number">13.1.</span> <span class="nav-text">1.参考</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%86%85%E9%83%A8%E5%BA%93"><span class="nav-number">13.2.</span> <span class="nav-text">2.内部库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Jenkins-%E5%86%85%E9%83%A8%E7%9A%84-workflowLibs-%E5%BA%93"><span class="nav-number">13.2.1.</span> <span class="nav-text">1.Jenkins 内部的 workflowLibs 库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Git-%E5%BA%93"><span class="nav-number">13.2.2.</span> <span class="nav-text">2.Git 库</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%A1%B9%E7%9B%AE-Jenkinsfile-%E6%96%87%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8"><span class="nav-number">13.3.</span> <span class="nav-text">3.项目 Jenkinsfile 文件的配置及使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Import-the-library"><span class="nav-number">13.3.1.</span> <span class="nav-text">1.Import the library</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Usage"><span class="nav-number">13.3.2.</span> <span class="nav-text">2.Usage</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-Jenkinsfile-Example"><span class="nav-number">13.3.3.</span> <span class="nav-text">3.Jenkinsfile Example</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Master-gt-Slave-%E6%9E%B6%E6%9E%84%E4%B8%8A%E4%BD%BF%E7%94%A8-Pipeline"><span class="nav-number">13.4.</span> <span class="nav-text">4.Master -&gt; Slave 架构上使用 Pipeline</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%9C%89-shared-library-%E6%97%B6"><span class="nav-number">13.4.1.</span> <span class="nav-text">1.有 shared library 时</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Tim</p>
  <div class="site-description" itemprop="description">个人技术记录</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">104</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tim</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        


  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=1279545088&web_id=1279545088"></script>
  </div>






      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>














  

  

</body>
</html>
